from marshmallow import Schema, fields, validates, ValidationError
from models.student import Student

class StudentSchema(Schema):
    """Schema for validating Student data"""

    id = fields.Int(dump_only=True)  # ID is generated by the database
    name = fields.Str(required=True)  # Name is required
    email = fields.Str(required=True)  # Email is required

    @validates('email')
    def validate_email(self, email):
        """Validate that the email is in a proper format."""
        if not isinstance(email, str) or len(email) == 0:
            raise ValidationError("E001: Email must not be empty")
        elif "@" not in email or "." not in email.split("@")[-1]:
            raise ValidationError("E002: Invalid email format")