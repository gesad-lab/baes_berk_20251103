# Tasks: Add Teacher Relationship to Course Entity

---
INCREMENTAL DEVELOPMENT CONTEXT

Existing Code to Build Upon:
- `models.py`
- `main.py`
- `tests/test_course_api.py`
- `tests/test_migrations.py`
- `tests/test_teacher_api.py`

---

## Task Breakdown

### Task 1: Update Course Model
- **File**: `src/models.py`
- **Description**: Modify the `Course` model to include a foreign key relationship to the `Teacher` model.
- **Action**: Add `teacher_id` field and set up SQLAlchemy relationship.
- **Dependencies**: None
- **Testable**: Ensure the model file compiles without errors.
- [ ] Implement `teacher_id` in `Course` model.

---

### Task 2: Implement Assign Teacher API Endpoint
- **File**: `src/main.py`
- **Description**: Create a PUT endpoint for assigning a teacher to a specific course.
- **HTTP Method**: PUT
- **Endpoint**: `/courses/{course_id}/assign_teacher`
- **Dependencies**: Task 1
- **Testable**: Send a PUT request to this endpoint with a valid payload and check for successful assignment response.
- [ ] Implement endpoint to assign teacher in `main.py`.

---

### Task 3: Implement Retrieve Course API Endpoint
- **File**: `src/main.py`
- **Description**: Create a GET endpoint to retrieve course details, including the assigned teacher.
- **HTTP Method**: GET
- **Endpoint**: `/courses/{course_id}`
- **Dependencies**: Task 1
- **Testable**: Send a GET request and check for successful retrieval of course and teacher details.
- [ ] Implement endpoint to retrieve course in `main.py`.

---

### Task 4: Implement Input Validation
- **File**: `src/main.py`
- **Description**: Write validation logic to ensure both course and teacher IDs exist before assignment.
- **Dependencies**: Tasks 2, 3
- **Testable**: Test with invalid IDs to confirm they result in appropriate error messages.
- [ ] Add validation for IDs in `assign_teacher` endpoint.

---

### Task 5: Database Migration for Teacher Relationship
- **File**: `migrations/versions/xxxxxxxxxxxx_add_teacher_relationship.py`
- **Description**: Create an Alembic migration to add the `teacher_id` column to the `courses` table.
- **Dependencies**: Task 1
- **Testable**: Run the migration to confirm the column is added without affecting existing data.
- [ ] Create Alembic migration script for `teacher_id`.

---

### Task 6: Update Tests for Course API
- **File**: `tests/test_course_api.py`
- **Description**: Write unit tests for the new API endpoints and validation logic.
- **Dependencies**: Tasks 2, 3, 4
- **Testable**: Run tests to ensure all scenarios (valid and invalid) pass.
- [ ] Add tests for assigning teacher and retrieving course details.

---

### Task 7: Update Tests for Database Migration
- **File**: `tests/test_migrations.py`
- **Description**: Validate that migrations for adding `teacher_id` work correctly without data loss.
- **Dependencies**: Task 5
- **Testable**: Run tests to ensure migration is applied successfully and data remains intact.
- [ ] Implement migration tests in `test_migrations.py`.

---

### Task 8: Documentation Update
- **File**: `README.md`
- **Description**: Update documentation to include new API endpoints and how to use them.
- **Dependencies**: Tasks 2, 3
- **Testable**: Ensure documentation accurately reflects new functionality and is clear for users.
- [ ] Revise `README.md` with new API info.

---

### Task 9: API Documentation Generation
- **File**: Code in `src/main.py` (via FastAPI)
- **Description**: Ensure that FastAPI generates updated OpenAPI documentation reflecting new endpoints.
- **Dependencies**: Tasks 2, 3
- **Testable**: Access the autogenerated docs and verify new endpoints appear correctly.
- [ ] Verify OpenAPI docs reflect all changes. 

---

This breakdown ensures focused, independent tasks that contribute to the overall implementation of the teacher-course relationship feature, aligning with the MVP goals. Each task is clearly delineated, ensuring easy assignment and tracking of progress.